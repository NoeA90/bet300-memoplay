<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BET300 ¬∑ Memotest R√°pido</title>
<meta name="theme-color" content="#0b0f1e"/>
<style>
:root{
  --bg:#0b0f1e; --panel:#121634; --panel2:#0f1330; --border:#1e2150;
  --text:#e8ebff; --muted:#b7b9d6; --ok:#25D366; --pointer:#22d3ee;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;color:var(--text);background:var(--bg);font:16px/1.35 system-ui,-apple-system,Segoe UI,Roboto}
body::before{content:"";position:fixed;inset:0;z-index:-2;background:
  radial-gradient(900px 500px at 50% -10%, rgba(101,74,255,.25), transparent),
  radial-gradient(700px 350px at 100% 0%, rgba(0,209,255,.18), transparent),
  linear-gradient(180deg,#0b0f1e 0%,#0b0f1e 60%,#0a0d20 100%);
}
.container{max-width:980px;margin:14px auto;padding:0 14px 92px}
.card{background: radial-gradient(120% 100% at 50% 0%, rgba(124,77,255,.08), transparent), var(--panel2);
  border:1px solid var(--border);border-radius:18px;padding:18px;box-shadow:0 15px 40px rgba(0,0,0,.35)}
@media(max-width:520px){.container{padding:0 0 92px}.card{border-radius:0;border-left:0;border-right:0;padding:14px}}
.head{display:flex;align-items:center;gap:10px;margin-bottom:8px;flex-wrap:wrap}
.brand{height:28px;width:auto;filter:drop-shadow(0 2px 8px rgba(0,0,0,.4))}
.pill{background:linear-gradient(90deg,rgba(124,77,255,.15),rgba(0,209,255,.15));border:1px solid var(--border);
  border-radius:999px;padding:6px 10px;font-size:12px;color:var(--muted)}
.pill.time{display:flex;gap:8px;align-items:center}
.pill.sound{cursor:pointer;user-select:none}
.count{display:inline-flex;gap:6px;align-items:center;padding:4px 8px;border-radius:999px;background:rgba(255,204,0,.15);
  border:1px solid rgba(255,204,0,.35);color:#ffe27a;font-weight:700;font-variant-numeric:tabular-nums}

.grid{display:grid;gap:16px;grid-template-columns:minmax(0,1fr)}
@media(min-width:900px){.grid{grid-template-columns:1.15fr .85fr}}

.panel{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px}
.center{text-align:center}
h1,h2,h3,p{margin:0 0 8px} h1{font-size:24px} .muted{color:var(--muted)}
.stat{display:flex;gap:12px;align-items:center;justify-content:center;margin:8px 0 14px}
.badge{min-width:72px;height:46px;border-radius:12px;background:radial-gradient(100% 100% at 50% 0%, rgba(0,209,255,.35), rgba(124,77,255,.35));
  display:grid;place-items:center;font-weight:800;font-size:18px;box-shadow:inset 0 0 10px rgba(124,77,255,.35)}
.smallline{font-size:12px;color:var(--muted);margin-top:4px}

/* Plataforma CTA */
.promo{display:grid;grid-template-columns:1fr minmax(200px,260px);align-items:center;gap:12px;margin-top:10px;padding:12px;border:1px dashed var(--border);border-radius:12px}
.promo.expired{border-color:rgba(255,107,107,.5)}
.promo .copy{display:grid;gap:4px}
.promo .eyebrow{padding:2px 8px;border-radius:999px;border:1px solid rgba(255,204,0,.35);background:rgba(255,204,0,.12);color:#ffe27a;font-weight:700;font-size:12px;width:max-content}
.btn.play{display:inline-flex;gap:10px;align-items:center;justify-content:center;padding:14px 16px;border-radius:12px;font-weight:800;
  background:linear-gradient(90deg,#ffd166,#ff7ab6);color:#0a0f20;box-shadow:0 8px 20px rgba(0,0,0,.25)}
@media(max-width:520px){.promo{grid-template-columns:1fr}.btn.play{width:100%}}

/* Dock inferior */
.dock{position:fixed;left:0;right:0;bottom:0;z-index:10;background:linear-gradient(180deg, rgba(11,15,30,0) 0%, rgba(11,15,30,.85) 22%, rgba(11,15,30,.95) 100%);
  padding:10px 16px 14px;display:flex;gap:12px;align-items:center}
.btn{appearance:none;border:none;cursor:pointer;padding:14px 16px;border-radius:14px;font-weight:800;background:linear-gradient(90deg,#6c59ff,#00d1ff);color:#0a0f20;width:100%;
  box-shadow:0 8px 20px rgba(0,0,0,.35)}
.btn:disabled{opacity:.55;cursor:not-allowed}
.btn.ok{background:#25D366;color:#0b0f1e}

/* ===== MEMOTEST ===== */
.stage{display:flex;align-items:center;justify-content:center}
.memo{display:grid;gap:10px;grid-template-columns:repeat(3,1fr);max-width:520px;margin:auto;min-height:320px}
@media(min-width:560px){.memo{grid-template-columns:repeat(4,1fr)}}

.cardx{position:relative;aspect-ratio:3/4;border-radius:14px;background:#0f1330;
  border:1px solid var(--border);overflow:hidden;cursor:pointer;perspective:800px}
.flip{position:relative;width:100%;height:100%;transition:transform .35s ease;transform-style:preserve-3d}
.cardx.revealed .flip{transform:rotateY(180deg)}
.face{position:absolute;inset:0;display:grid;place-items:center;backface-visibility:hidden}
.front{background:linear-gradient(180deg,#11163a,#0c1230)}
.back{transform:rotateY(180deg);background:radial-gradient(120% 100% at 50% 0%, rgba(124,77,255,.10), transparent), #0c1230}
.face canvas{display:block;width:100%;height:100%}

.hint{font-size:13px;color:var(--muted);text-align:center;margin-top:8px}

/* Confetti */
.confetti{position:fixed;inset:0;pointer-events:none;z-index:40}
.confetti i{position:absolute;top:-20px;width:10px;height:14px;border-radius:2px;opacity:0;animation:confFall 1.6s linear forwards}
@keyframes confFall{8%{opacity:1}100%{transform:translateY(110vh) rotate(360deg);opacity:0}}
</style>
</head>
<body>

<!-- papelitos -->
<div id="confetti" class="confetti" aria-hidden="true"></div>

<div class="container">
  <div class="card">
    <div class="head">
      <img class="brand" src="img/logo-bet300.svg" alt="BET300" onerror="this.outerHTML='<strong>BET300</strong>'">
      <span class="pill">Promo interactiva</span>
      <span class="pill time">‚ö° Tiempo limitado <span class="count" id="countdown">--:--</span></span>
      <span class="pill sound" id="soundToggle">üîä Sonido: <b id="soundState">ON</b></span>
    </div>

    <div class="grid">
      <div class="panel">
        <div class="center">
          <h1 id="title">Memotest r√°pido ¬∑ Encontr√° 1 par</h1>
          <p class="muted" id="subtitle">Ten√©s <b id="triesLeft">3 intentos</b> (m√°x. 6 volteos). Si hac√©s 1 par, acced√©s al <b>premio mayor</b>. Si no, hay <b>premio garantizado</b>.</p>
          <div class="hint">Toc√° 2 cartas para intentar un match.</div>
        </div>

        <div class="stage" style="margin-top:12px">
          <div id="memo" class="memo"></div>
        </div>
      </div>

      <div class="panel">
        <div class="center">
          <div class="stat">
            <div>
              <div class="badge" id="badge">-</div>
              <div class="smallline" id="stampLine" aria-live="polite"></div>
            </div>
            <div>
              <h1 id="statusTitle">Ten√©s 1 chance hoy</h1>
              <p class="muted" id="statusSub">Los premios se acreditan con tu <b>pr√≥xima carga m√≠nima</b>.</p>
            </div>
          </div>
        </div>

        <div class="promo" id="promoBox">
          <div class="copy">
            <span class="eyebrow">Acceso especial</span>
            <strong>Tiempo limitado.</strong>
            <span class="muted">Entr√° y particip√° antes de que termine.</span>
          </div>
          <a id="playNow" class="btn play" target="_blank" rel="noopener">
            <span class="icon">üéÆ</span>
            <span class="label">Entrar a la plataforma</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Dock fijo -->
<div class="dock">
  <button id="retryBtn" class="btn" disabled>üîÅ Volver a intentar</button>
  <button id="claimBtn" class="btn ok" disabled>üì≤ Reclamar</button>
</div>

<script>
/* ===== Premios ===== */
const HIGH_PRIZES=[{type:'money',value:5000},{type:'money',value:4000},{type:'percent',value:20},{type:'percent',value:15}];
const BASE_PRIZES=[{type:'money',value:2000},{type:'money',value:1000},{type:'percent',value:10}];
const money=n=>"$"+n.toLocaleString("es-AR");
const label=p=>p.type==='money'?money(p.value):(`${p.value}%`);
const describe=p=>p.type==='money'?`Recib√≠s <b>${money(p.value)} extra</b> con tu pr√≥xima carga.`:`Recib√≠s un <b>${p.value}% extra</b> con tu pr√≥xima carga.`;

/* ===== WhatsApp / plataforma (como tu ruleta original de 3 PCs) ===== */
const WP_NUMBERS={principal:"5491157737173",pc1:"5491138601132",pc2:"5491138214312",pc3:"5491166306349"};
const PLATFORM_LINKS={principal:"https://plataforma.example/inicio",pc1:"https://c01.bet300vip.com/",pc2:"https://c02.bet300vip.com/",pc3:"https://c03.bet300vip.com/"};
const params=new URLSearchParams(location.search);const pc=params.get('pc');
let WP=WP_NUMBERS.principal, PLATFORM=PLATFORM_LINKS.principal;
if(pc==='1'){WP=WP_NUMBERS.pc1;PLATFORM=PLATFORM_LINKS.pc1}
if(pc==='2'){WP=WP_NUMBERS.pc2;PLATFORM=PLATFORM_LINKS.pc2}
if(pc==='3'){WP=WP_NUMBERS.pc3;PLATFORM=PLATFORM_LINKS.pc3}
document.getElementById('playNow').href=PLATFORM;

/* ===== Antifraude / WhatsApp ===== */
const SALT="bet300-memotest-v1";
function ensureDeviceId(){let id=localStorage.getItem('device_id');if(!id){id=(crypto.randomUUID?.()||`${Date.now()}-${Math.random().toString(36).slice(2,8)}`);localStorage.setItem('device_id',id);}return id;}
const DEVICE_ID=ensureDeviceId();
function todayKey(){const n=new Date();return `${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,'0')}-${String(n.getDate()).padStart(2,'0')}`}
function tsString(d=new Date()){const dd=String(d.getDate()).padStart(2,'0'),mm=String(d.getMonth()+1).padStart(2,'0'),yyyy=d.getFullYear();const hh=String(d.getHours()).padStart(2,'0'),mi=String(d.getMinutes()).padStart(2,'0');return `${dd}/${mm}/${yyyy} ${hh}:${mi}`}
async function sha256hex(msg){const enc=new TextEncoder().encode(msg);const buf=await crypto.subtle.digest("SHA-256",enc);return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,"0")).join("")}
async function makeClaimCode(prizeLabel){const base=`${DEVICE_ID}|${todayKey()}|${prizeLabel}|pc:${pc||'0'}|${SALT}`;const hex=await sha256hex(base);return hex.slice(0,10).toUpperCase()}
function whatsappText(prizeLabel){const code=localStorage.getItem('memo_code')||'(SIN-COD)';const ts=localStorage.getItem('memo_ts')||tsString();return `Hola, gan√© ${prizeLabel} en el memotest y quiero reclamarlo con mi pr√≥xima carga. C√≥digo: ${code} ¬∑ ${ts}`}

/* ===== Audio simple ===== */
let soundOn=true;const soundToggle=document.getElementById('soundToggle');const soundState=document.getElementById('soundState');
const AudioKit=(()=>{const Ctx=window.AudioContext||window.webkitAudioContext;const ctx=new Ctx();let unlocked=false;
  function unlock(){if(!unlocked){ctx.resume().catch(()=>{});unlocked=true;}}
  function fx(freq=880,dur=.08,vol=.09){const o=ctx.createOscillator(),g=ctx.createGain();o.type='sine';o.frequency.value=freq;g.gain.value=0;o.connect(g).connect(ctx.destination);const t=ctx.currentTime;g.gain.linearRampToValueAtTime(vol,t+.005);g.gain.exponentialRampToValueAtTime(.0001,t+dur);o.start(t);o.stop(t+dur)}
  function good(){[660,880,1320].forEach((f,i)=>setTimeout(()=>fx(f,.12,.12),i*120))}
  function flip(){fx(520,.06,.06)}
  return {unlock,good,flip};
})();
soundToggle.addEventListener('click',()=>{soundOn=!soundOn;soundState.textContent=soundOn?'ON':'OFF'});

/* ===== Countdown / Reset diario ===== */
const countdownEl=document.getElementById('countdown'), promoBox=document.getElementById('promoBox');
function endOfDay(){const n=new Date();const end=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,0,0).getTime();return end>Date.now()?end:new Date(n.getFullYear(),n.getMonth(),n.getDate()+1,23,59,0,0).getTime()}
function tickCountdown(){const ms=endOfDay()-Date.now();const total=Math.max(0,Math.floor(ms/1000));const h=Math.floor(total/3600),m=Math.floor((total%3600)/60),s=total%60;countdownEl.textContent=h>0?`${h}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`:`${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;if(ms<=0){promoBox.classList.add('expired')}}
setInterval(tickCountdown,1000);

/* ===== Confetti ===== */
const confetti=document.getElementById('confetti');
function confettiBurst(){confetti.innerHTML='';for(let i=0;i<28;i++){const p=document.createElement('i');p.style.left=(Math.random()*100)+'vw';p.style.animationDelay=(Math.random()*0.5)+'s';p.style.background=Math.random()<.5?'linear-gradient(#80ffea,#4e9cff)':'linear-gradient(#ffd166,#ff3d7f)';confetti.appendChild(p)}setTimeout(()=>confetti.innerHTML='',1800)}

/* ===== Canvas helpers ===== */
function fitCanvas(canvas){
  const rect = canvas.getBoundingClientRect();
  const dpr = window.devicePixelRatio || 1;
  canvas.width  = Math.max(1, Math.round(rect.width * dpr));
  canvas.height = Math.max(1, Math.round(rect.height * dpr));
  const ctx = canvas.getContext('2d');
  ctx.setTransform(dpr,0,0,dpr,0,0);
  return {ctx,w:rect.width,h:rect.height,dpr};
}
function drawFront(c){
  const {ctx,w,h,dpr} = fitCanvas(c);
  // fondo gradiente
  const grad = ctx.createLinearGradient(0,0,w,h);
  grad.addColorStop(0,'#7c4dff'); grad.addColorStop(0.5,'#22d3ee'); grad.addColorStop(1,'#ff7ab6');
  ctx.fillStyle = grad; ctx.fillRect(0,0,w,h);

  // franjas diagonales (con save/restore para no romper la matriz)
  ctx.save();
  ctx.translate(w/2,h/2);
  ctx.rotate(-Math.PI/8);
  ctx.fillStyle='rgba(255,255,255,.12)';
  const W=w*1.6, H=h*1.6;
  for(let x=-W; x<W; x+=16){ ctx.fillRect(x,-H,8,H*2); }
  ctx.restore();

  // marco
  ctx.strokeStyle='rgba(255,255,255,.35)'; ctx.lineWidth=3; ctx.strokeRect(6,6,w-12,h-12);

  // texto
  ctx.fillStyle='#0b0f1e'; ctx.font='700 26px system-ui,Segoe UI'; ctx.textAlign='center'; ctx.textBaseline='middle';
  ctx.fillText('RASC√Å', w/2, h/2);
}
function drawStar(ctx,cx,cy,ro,ri,pts){ctx.beginPath();for(let i=0;i<pts*2;i++){const r=i%2?ri:ro;const a=-Math.PI/2+i*Math.PI/pts;const x=cx+Math.cos(a)*r;const y=cy+Math.sin(a)*r;i?ctx.lineTo(x,y):ctx.moveTo(x,y)}ctx.closePath();}
function drawSymbol(c,type){
  const {ctx,w,h} = fitCanvas(c);
  const bg=ctx.createRadialGradient(w/2,h*0.2,10,w/2,h*0.2,Math.max(w,h));
  bg.addColorStop(0,'rgba(124,77,255,.18)'); bg.addColorStop(1,'transparent');
  ctx.fillStyle='#0c1230'; ctx.fillRect(0,0,w,h); ctx.fillStyle=bg; ctx.fillRect(0,0,w,h);
  ctx.save(); ctx.translate(w/2,h/2);
  switch(type){
    case 'star':
      ctx.fillStyle='#ffd166'; drawStar(ctx,0,0,Math.min(w,h)*0.26,Math.min(w,h)*0.12,5); ctx.fill();
      ctx.lineWidth=2; ctx.strokeStyle='rgba(255,255,255,.5)'; ctx.stroke(); break;
    case 'diamond':
      ctx.fillStyle='#7ae0ff'; ctx.beginPath(); ctx.moveTo(0,-h*0.28); ctx.lineTo(w*0.22,0); ctx.lineTo(0,h*0.28); ctx.lineTo(-w*0.22,0); ctx.closePath(); ctx.fill(); break;
    case 'heart':
      ctx.fillStyle='#ff6ad5'; ctx.beginPath(); ctx.moveTo(0,h*0.20);
      ctx.bezierCurveTo(-w*0.28,-h*0.06,-w*0.18,-h*0.28,0,-h*0.16);
      ctx.bezierCurveTo(w*0.18,-h*0.28,w*0.28,-h*0.06,0,h*0.20); ctx.fill(); break;
    case 'clover':
      ctx.fillStyle='#34d39a';
      for(let k=0;k<3;k++){const a=k*2*Math.PI/3; ctx.beginPath(); ctx.arc(Math.cos(a)*w*0.16,Math.sin(a)*h*0.16, Math.min(w,h)*0.12,0,2*Math.PI); ctx.fill();}
      ctx.beginPath(); ctx.moveTo(0,h*0.08); ctx.lineTo(0,h*0.30); ctx.lineWidth=10; ctx.strokeStyle='#34d39a'; ctx.stroke(); break;
    case 'bolt':
      ctx.fillStyle='#a78bfa'; ctx.beginPath();
      ctx.moveTo(-w*0.06,-h*0.30); ctx.lineTo(w*0.10,-h*0.08); ctx.lineTo(-w*0.02,-h*0.08);
      ctx.lineTo(w*0.06,h*0.30); ctx.lineTo(-w*0.12,h*0.06); ctx.lineTo(w*0.00,h*0.06);
      ctx.closePath(); ctx.fill(); break;
    case 'cherry':
      ctx.fillStyle='#ff4f6d'; ctx.beginPath();
      ctx.arc(-w*0.14,h*0.03, Math.min(w,h)*0.11,0,2*Math.PI);
      ctx.arc( w*0.14,h*0.03, Math.min(w,h)*0.11,0,2*Math.PI); ctx.fill();
      ctx.strokeStyle='#66cc66'; ctx.lineWidth=6; ctx.beginPath();
      ctx.moveTo(-w*0.14,h*0.03); ctx.quadraticCurveTo(-w*0.06,-h*0.20,0,-h*0.24);
      ctx.quadraticCurveTo(w*0.06,-h*0.20, w*0.14,h*0.03); ctx.stroke(); break;
  }
  ctx.restore();
}

/* ===== Memotest ===== */
const memoEl=document.getElementById('memo');
const triesLeftEl=document.getElementById('triesLeft');
const badge=document.getElementById('badge'), stampEl=document.getElementById('stampLine');
const statusTitle=document.getElementById('statusTitle'), statusSub=document.getElementById('statusSub');
const retryBtn=document.getElementById('retryBtn'), claimBtn=document.getElementById('claimBtn');

const SYMBOL_TYPES=['star','diamond','heart','clover','bolt','cherry'];
let deck=[], open=[], tries=3, locked=false;

function cardTemplate(type, idx){
  return `
  <div class="cardx" data-idx="${idx}">
    <div class="flip">
      <div class="face front"><canvas id="f${idx}"></canvas></div>
      <div class="face back"><canvas id="b${idx}"></canvas></div>
    </div>
  </div>`;
}

function buildDeck(){
  const pairs = SYMBOL_TYPES.concat(SYMBOL_TYPES); // 12
  for(let i=pairs.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[pairs[i],pairs[j]]=[pairs[j],pairs[i]]}
  deck = pairs.map((type,i)=>({type, id:i}));
  memoEl.innerHTML = deck.map((c,i)=>cardTemplate(c.type,i)).join('');
  // esperar layout y dibujar
  requestAnimationFrame(()=>{ deck.forEach((c,i)=>{ drawFront(document.getElementById(`f${i}`)); drawSymbol(document.getElementById(`b${i}`), c.type); }); });
}

function updateTries(){ triesLeftEl.textContent = `${tries} ${tries===1?'intento':'intentos'}`; }

function attachHandlers(){
  memoEl.querySelectorAll('.cardx').forEach(el=>{
    el.addEventListener('click',()=>{
      if(locked || el.classList.contains('revealed') || localStorage.getItem('memo_done')==='1') return;
      if(soundOn) AudioKit.flip();
      el.classList.add('revealed');
      open.push(el);
      if(open.length===2){
        locked=true;
        const [a,b]=open;
        const ai=deck[+a.dataset.idx], bi=deck[+b.dataset.idx];
        setTimeout(()=>{
          if(ai.type===bi.type){
            finishGame(true);
          } else {
            a.classList.remove('revealed'); b.classList.remove('revealed');
            tries--; updateTries();
            if(tries===0){ finishGame(false); }
          }
          open=[]; locked=false;
        }, 520);
      }
    });
  });
}

/* Redibujar en resize/rotaci√≥n */
addEventListener('resize', ()=> {
  deck.forEach((c,i)=>{
    const f=document.getElementById(`f${i}`), b=document.getElementById(`b${i}`);
    if(f&&b){ drawFront(f); drawSymbol(b,c.type); }
  });
});

/* Persistencia diaria */
function restoreDaily(){
  const today=todayKey(); const stored=localStorage.getItem('memo_date');
  if(stored && stored!==today){
    ["memo_done","memo_prize","memo_code","memo_ts"].forEach(k=>localStorage.removeItem(k));
    localStorage.setItem('memo_date', today);
  } else if(!stored){ localStorage.setItem('memo_date', today) }
}
function restoreIfAny(){
  const done=localStorage.getItem('memo_done')==='1';
  if(!done) return;
  const p=JSON.parse(localStorage.getItem('memo_prize')||'null');
  const code=localStorage.getItem('memo_code')||'‚Äî';
  const ts=localStorage.getItem('memo_ts')||tsString();
  if(p){
    badge.textContent = label(p);
    statusTitle.textContent = "üéâ ¬°Premio obtenido!";
    statusSub.innerHTML = describe(p);
    stampEl.textContent = `C√≥digo: ${code} ¬∑ ${ts}`;
  }
  retryBtn.disabled = true; claimBtn.disabled = false;
  const msg = whatsappText(badge.textContent || 'premio');
  claimBtn.onclick = ()=>location.href=`https://wa.me/${WP}?text=${encodeURIComponent(msg)}`;
}

/* Final */
async function finishGame(win){
  const pool = win ? HIGH_PRIZES : BASE_PRIZES;
  const prize = pool[Math.floor(Math.random()*pool.length)];
  const prizeLabel = label(prize);

  const code = await makeClaimCode(prizeLabel);
  const ts   = tsString(new Date());
  localStorage.setItem('memo_code', code);
  localStorage.setItem('memo_ts', ts);
  localStorage.setItem('memo_done', '1');
  localStorage.setItem('memo_prize', JSON.stringify(prize));

  badge.textContent = prizeLabel;
  statusTitle.textContent = "üéâ ¬°Premio obtenido!";
  statusSub.innerHTML = describe(prize);
  stampEl.textContent = `C√≥digo: ${code} ¬∑ ${ts}`;

  retryBtn.disabled = true; claimBtn.disabled = false;
  const msg = whatsappText(prizeLabel);
  claimBtn.onclick = ()=>location.href=`https://wa.me/${WP}?text=${encodeURIComponent(msg)}`;

  confettiBurst(); if(soundOn) AudioKit.good();
}

/* Retry */
document.getElementById('retryBtn').addEventListener('click', ()=>{
  if(localStorage.getItem('memo_done')==='1') return;
  memoEl.innerHTML=''; open=[]; tries=3; updateTries(); buildDeck(); attachHandlers();
});

/* Init */
function init(){
  updateTries(); restoreDaily(); restoreIfAny(); buildDeck(); attachHandlers(); tickCountdown();
  document.addEventListener('click',()=>AudioKit.unlock(),{once:true});
  document.getElementById('retryBtn').disabled = localStorage.getItem('memo_done')==='1';
}
init();
</script>
</body>
</html>
